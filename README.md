Difficult version of TOP's challenge
